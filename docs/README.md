# API Documentation

This directory contains both manual and generated OpenAPI specifications and documentation for the Go Template API.

## Documentation Approaches

The project now supports **two approaches** for API documentation:

### 1. Manual OpenAPI Specification (Recommended for Production)
- `openapi.yaml` - Manually crafted OpenAPI 3.x specification
- Complete control over documentation structure
- OpenAPI 3.x format with modern features

### 2. Generated from Code Annotations (Developer-Friendly)
- `openapi-generated.yaml` - Auto-generated from Go code annotations
- Always reflects actual code implementation
- Swagger 2.0 format (generated by swaggo)

## Files

- `openapi.yaml` - **Manual** OpenAPI 3.x specification
- `openapi-generated.yaml` - **Generated** Swagger 2.0 specification from code
- `redoc.html` - Redoc documentation UI (works with both specs)
- `swagger-ui.html` - Swagger UI documentation (works with both specs)
- `docs.go` - Generated Go documentation (swaggo output)

## Viewing Documentation

### Local Development

1. Start the API server:
   ```bash
   make build
   ./build/service
   ```

2. Open documentation in your browser:
   - **Redoc**: Open `docs/redoc.html` in your browser (points to manual spec)
   - **Swagger UI**: Open `docs/swagger-ui.html` in your browser (points to manual spec)

### Serve with HTTP Server

For better CORS handling, serve the files via HTTP:

```bash
# Using Python
cd docs && python3 -m http.server 8000

# Using Node.js
cd docs && npx serve
```

Then access:
- Redoc (Manual): http://localhost:8000/redoc.html
- Swagger UI (Manual): http://localhost:8000/swagger-ui.html

## Generating Documentation

### From Code Annotations
```bash
# Generate OpenAPI spec from Go code annotations
make openapi-generate

# This creates:
# - docs/openapi-generated.yaml (Swagger 2.0)
# - docs/openapi-generated.json 
# - docs/docs.go (Go integration)
```

### Manual Specification
The manual `openapi.yaml` provides complete control and uses modern OpenAPI 3.x features.

## SDK Generation Options

### From Manual Specification (OpenAPI 3.x)
```bash
make sdks  # Generate all SDKs from manual spec
```

### From Generated Specification (Swagger 2.0)
```bash
make sdks-generated  # Generate all SDKs from code annotations
```

## Code Annotations Format

Add annotations to your handlers:

```go
// CreateExample godoc
//
//	@Summary		Create a new example
//	@Description	Create a new example with title and content
//	@Tags			examples
//	@Accept			json
//	@Produce		json
//	@Security		BearerAuth
//	@Param			example	body	CreateExampleRequest	true	"Example to create"
//	@Success		201	{object}	CreateExampleResponse
//	@Failure		400	{object}	map[string]string
//	@Router			/api/v1/examples [post]
func (h *ExampleHandler) CreateExample(w http.ResponseWriter, r *http.Request) {
    // Implementation
}
```

## Updating Documentation

### For Code-First Approach
1. Add/update annotations in your handler functions
2. Run `make openapi-generate` to regenerate spec
3. Run `make sdks-generated` to regenerate SDKs

### For Manual Specification
1. Update the `openapi.yaml` file with new paths, components, etc.
2. Run `make sdks` to regenerate SDKs
3. The documentation UIs will automatically reflect changes

## Choosing the Right Approach

**Use Code Annotations When:**
- You prefer documentation close to code
- You want automatic sync between code and docs
- Your team prioritizes developer workflow

**Use Manual Specification When:**
- You need precise control over documentation
- You want to use OpenAPI 3.x features
- You need comprehensive examples and descriptions
- You're following API-first design principles

## Features Comparison

| Feature | Manual (OpenAPI 3.x) | Generated (Swagger 2.0) |
|---------|---------------------|-------------------------|
| Format | OpenAPI 3.0.3 | Swagger 2.0 |
| Control | Complete | Code-driven |
| Sync | Manual | Automatic |
| Examples | Rich examples | Basic examples |
| Security | Advanced schemes | Basic schemes |
| Maintenance | Manual updates | Code annotations |